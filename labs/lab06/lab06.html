<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lab No. 6: I/O Redirection &#8212; CS210 Introduction to Unix  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link href="https://fonts.googleapis.com/css?family=Lusitana|Roboto|Roboto+Mono" rel="stylesheet">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          CS210 Introduction to Unix</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../syllabus.html">CS210 Introduction to Unix - Spring 2020</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conv/conv.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule.html">Course Schedule and Materials</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Lab No. 6: I/O Redirection</a><ul>
<li><a class="reference internal" href="#standard-input-standard-output-and-standard-error">Standard Input, Standard Output and Standard Error</a><ul>
<li><a class="reference internal" href="#redirection-operators">Redirection Operators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#redirecting-stdout-and-stderr">Redirecting stdout and stderr</a><ul>
<li><a class="reference internal" href="#the-cat-command">The <code class="docutils literal"><span class="pre">cat</span></code> command</a></li>
<li><a class="reference internal" href="#the-bit-bucket">The bit bucket</a></li>
</ul>
</li>
<li><a class="reference internal" href="#redirecting-stdin">Redirecting stdin</a></li>
<li><a class="reference internal" href="#using-pipes">Using Pipes</a><ul>
<li><a class="reference internal" href="#the-grep-command">The <code class="docutils literal"><span class="pre">grep</span></code> command</a></li>
<li><a class="reference internal" href="#the-tee-command">The <code class="docutils literal"><span class="pre">tee</span></code> command</a></li>
<li><a class="reference internal" href="#the-uniq-command">The <code class="docutils literal"><span class="pre">uniq</span></code> command</a></li>
<li><a class="reference internal" href="#the-sort-command">The <code class="docutils literal"><span class="pre">sort</span></code> command</a></li>
<li><a class="reference internal" href="#the-head-and-tail-commands">The <code class="docutils literal"><span class="pre">head</span></code> and <code class="docutils literal"><span class="pre">tail</span></code> commands</a></li>
<li><a class="reference internal" href="#building-a-command-pipeline">Building a command pipeline</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/labs/lab06/lab06.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="lab-no-6-i-o-redirection">
<h1>Lab No. 6: I/O Redirection<a class="headerlink" href="#lab-no-6-i-o-redirection" title="Permalink to this headline">¶</a></h1>
<p>After completing this lab, students will be able to:</p>
<ul class="simple">
<li>describe <em>stdout</em>, <em>stdin</em> and <em>stderr</em></li>
<li>run commands that employ I/O redirection</li>
<li>work with the contents of files through the <code class="docutils literal"><span class="pre">cat</span></code> command</li>
<li>apply the <code class="docutils literal"><span class="pre">tee</span></code>, <code class="docutils literal"><span class="pre">sort</span></code> and <code class="docutils literal"><span class="pre">uniq</span></code> commands</li>
<li>apply <code class="docutils literal"><span class="pre">/dev/null</span></code> to discard output or errors</li>
</ul>
<div class="section" id="standard-input-standard-output-and-standard-error">
<h2>Standard Input, Standard Output and Standard Error<a class="headerlink" href="#standard-input-standard-output-and-standard-error" title="Permalink to this headline">¶</a></h2>
<p>So far in this class we have run commands and have seen how their output is printed on the screen.
Also, we have focused our attention in running commands that receive their input from key presses obtained from your keyboard.
In this section of the lab we are going to learn how to change the way we can interact with the output produced by programs and also change the way programs receive input.
This is done through a mechanism known as <em>I/O redirection</em>.</p>
<p>When you execute commands, the operating system creates a <em>process</em>.</p>
<p>Three important file descriptors are assigned to each process:</p>
<ul class="simple">
<li>0: <em>stdin</em></li>
<li>1: <em>stdout</em></li>
<li>2: <em>stderr</em></li>
</ul>
<p>Standard output, or <em>stdout</em>, is the file where the process write its output.
Processes do not need to “know” where the data that they output will be written, it can go to a device (e.g. printer), an ordinary file, a socket, a screen (which is the default behavior for interactive shell sessions), etc.
The operating system abstracts the end point where the output is written. By default, for interactive process, <em>stdout</em> is mapped to the pseudoterminal where the command is executed.</p>
<p>Standard input, or <em>stdin</em>, is the file where the program gets information from.
In the same fashion as <em>stdout</em>, the operating system controls the file that a process uses to receive input. By default, for interactive commands, <em>stdin</em> is mapped to the keyboard attached to the pseudoterminal where the command is executed.</p>
<p>Standard error, or <em>stderr</em>, is the file where errors are written, and for interactive sessions if defaults to the screen. Just as <em>stdout</em>, for interactive applications <em>stderr</em> is mapped to the pseudoterminal where the command is executed</p>
<p>To be more technically accurate <em>stdin</em>, <em>stdout</em> and <em>sterr</em> are “I/O streams”, instead of regular files that are save to disk.
Unix has the philosophy <strong>that everything is a file</strong> as far as I/O is concerned.
What that means in practical terms is that you can use the same library functions and interfaces without worrying about whether the file you are working is an I/O stream connected to a keyboard, a disk file, a socket, a pipe, or any other I/O abstraction</p>
<div class="section" id="redirection-operators">
<h3>Redirection Operators<a class="headerlink" href="#redirection-operators" title="Permalink to this headline">¶</a></h3>
<p>The following table has some common operators that are used to change where bytes read from <em>stdin</em> come from, or where bytes written to  <em>stdout</em> and <em>stderr</em> go to:</p>
<table border="1" class="table-striped docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Effect</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&gt;</span></code></td>
<td>Redirects stdout to a new file. If the file exists, it will be overwritten.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&gt;&gt;</span></code></td>
<td>Appends stdout to an existing file. If the file does not exist, it will be created.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">2&gt;</span></code></td>
<td>Redirects stder to a new file. If the file exists, it will be overwritten.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">2&gt;&gt;</span></code></td>
<td>Appends stderr to an existing file. If the file does not exist, it will be created.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&amp;&gt;</span></code></td>
<td>Redirects both stdout and stderr to a new file. If the file exists, it will be overwritten.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&amp;&gt;&gt;</span></code></td>
<td>Appends both stdout and stderr to an existing file. If the file does not exist, it will be created.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">2&gt;&amp;1</span></code></td>
<td>Redirects stderr to stdout</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&gt;&amp;2</span></code></td>
<td>Redirects stdout to stderr</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;</span></code></td>
<td>Redirects stdin to read from a file.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&lt;&lt;</span></code></td>
<td>Uses text in several lines as stdin (know as a <em>heredoc</em>)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="redirecting-stdout-and-stderr">
<h2>Redirecting stdout and stderr<a class="headerlink" href="#redirecting-stdout-and-stderr" title="Permalink to this headline">¶</a></h2>
<p>Let’s see some example of redirection in action.
First let’s list all the files that start with <code class="docutils literal"><span class="pre">c</span></code> within <code class="docutils literal"><span class="pre">/var/log</span></code>:</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">ls -ld /var/log/c*</strong>
drwx------  2 cassandra cassandra    4096 Oct  4  2018 /var/log/cassandra
drwxr-xr-x. 2 chrony    chrony       4096 Apr  4  2018 /var/log/chrony
drwxr-xr-x. 2 root      root         4096 Apr 12  2018 /var/log/cluster
-rw-------  1 root      root       136803 Mar  1 13:33 /var/log/cron
-rw-------  1 root      root      5113530 Feb 10 04:50 /var/log/cron-20200209
-rw-------  1 root      root      4510889 Feb 16 11:53 /var/log/cron-20200216
-rw-------  1 root      root      4781538 Feb 23 11:50 /var/log/cron-20200223
-rw-------  1 root      root      4790354 Mar  1 13:33 /var/log/cron-20200301
drwxr-xr-x. 2 lp        sys          4096 Aug  6  2018 /var/log/cups
drwx------  2 custodia  custodia     4096 Aug  7  2017 /var/log/custodia
</pre>
<p>Suppose you want to save the output of the find command to a file called <code class="docutils literal"><span class="pre">clogs.txt</span></code>.
You can use redirection in the following way:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">ls -ld /var/log/c* &gt; clogs.txt</strong>
</pre>
<div class="section" id="the-cat-command">
<h3>The <code class="docutils literal"><span class="pre">cat</span></code> command<a class="headerlink" href="#the-cat-command" title="Permalink to this headline">¶</a></h3>
<p>In this lab we are going to make heavy use of the <code class="docutils literal"><span class="pre">cat</span></code> command.
This command is used to read the contents of files and write them to <em>stdout</em>.</p>
<p>If you call the comand with arguments, they are interpreted as a list of files.  For example, if you execute <code class="docutils literal"><span class="pre">cat</span> <span class="pre">somefile1.txt</span> <span class="pre">somefile2.txt</span></code> it will read <code class="docutils literal"><span class="pre">somefile1.txt</span></code> and <code class="docutils literal"><span class="pre">somefile2.txt</span></code> and write their contents to <em>stdout</em></p>
<p>Let’s use <code class="docutils literal"><span class="pre">cat</span></code> inspect the output of <code class="docutils literal"><span class="pre">clogs.txt</span></code> and compare with the output you obtained in the terminal.
We should see exactly the same output (well, the file sizes and time stamps <em>could</em> have changed if by any chance a cron job was executed between commands).</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">cat clogs.txt</strong>
drwx------  2 cassandra cassandra    4096 Oct  4  2018 /var/log/cassandra
drwxr-xr-x. 2 chrony    chrony       4096 Apr  4  2018 /var/log/chrony
drwxr-xr-x. 2 root      root         4096 Apr 12  2018 /var/log/cluster
-rw-------  1 root      root       136803 Mar  1 13:33 /var/log/cron
-rw-------  1 root      root      5113530 Feb 10 04:50 /var/log/cron-20200209
-rw-------  1 root      root      4510889 Feb 16 11:53 /var/log/cron-20200216
-rw-------  1 root      root      4781538 Feb 23 11:50 /var/log/cron-20200223
-rw-------  1 root      root      4790354 Mar  1 13:33 /var/log/cron-20200301
drwxr-xr-x. 2 lp        sys          4096 Aug  6  2018 /var/log/cups
drwx------  2 custodia  custodia     4096 Aug  7  2017 /var/log/custodia
</pre>
<p>Now let’s try something similar, but this time let’s use the <code class="docutils literal"><span class="pre">find</span></code> command</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">find /var/log/c*</strong>
/var/log/cassandra
find: ‘/var/log/cassandra’: Permission denied
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
find: ‘/var/log/custodia’: Permission denied
</pre>
<p>Notice that <code class="docutils literal"><span class="pre">find</span></code> presents you with some <em>Permission denied</em> errors for those directories where it can not list their contents because you don’t have permission.
Remember that <code class="docutils literal"><span class="pre">find</span></code> by default tries to recursively list subdirectories, and in this case it is unssucessfully trying to list the contentw of <code class="docutils literal"><span class="pre">/var/log/cassandra</span></code> and <code class="docutils literal"><span class="pre">/var/log/custodia</span></code>.</p>
<p>Now, let’s write the output of the find command to <code class="docutils literal"><span class="pre">clogs.txt</span></code>:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">find /var/log/c* &gt; clogs.txt</strong>
find: ‘/var/log/cassandra’: Permission denied
find: ‘/var/log/custodia’: Permission denied
</pre>
<p>The first thing you should notice is how the <em>Permission denied</em> errors were still written to the terminal screen.
Let’s read the contents of <code class="docutils literal"><span class="pre">clogs.txt</span></code> using the <code class="docutils literal"><span class="pre">cat</span></code> command and notice how the listing did not include the error messages, and also that the <code class="docutils literal"><span class="pre">clogs.txt</span></code> file was completely <strong>overwritten</strong>:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">cat clogs.txt</strong>
/var/log/cassandra
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
</pre>
<p>What happened here is that the <em>Permission denied</em> messages are actually written to <em>stderr</em>.
Since the <code class="docutils literal"><span class="pre">&gt;</span></code> operator only redirects <em>stdout</em>, anything that the command wrote to <em>stderr</em> still gets written to the terminal.
Let’s try redirecting <em>stderr</em> to <code class="docutils literal"><span class="pre">clogs.txt</span></code>:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">find /var/log/c* 2&gt; clogs.txt</strong>
/var/log/cassandra
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
</pre>
<p>Notice how this time <code class="docutils literal"><span class="pre">clogs.txt</span></code> only has the error messages:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">cat clogs.txt</strong>
find: ‘/var/log/cassandra’: Permission denied
find: ‘/var/log/custodia’: Permission denied
</pre>
<p>We can also redirect both <em>stdout</em> and <em>stderr</em> to a file:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">find /var/log/c* &amp;&gt; clogs.txt</strong>
[user&#64;blue lab06]$ <strong class="command">cat clogs.txt</strong>
/var/log/cassandra
find: ‘/var/log/cassandra’: Permission denied
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
find: ‘/var/log/custodia’: Permission denied
</pre>
<p>Another idiom that is commonly used to write both <em>stdout</em> and <em>stderr</em> to a file is to first redirect <em>stderr</em> to <em>stdout</em> and then <em>stdout</em> to a file:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">find /var/log/c* &gt; clogs.txt 2&gt;&amp;1</strong>
[user&#64;blue lab06]$ <strong class="command">cat clogs.txt</strong>
/var/log/cassandra
find: ‘/var/log/cassandra’: Permission denied
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
find: ‘/var/log/custodia’: Permission denied
</pre>
<p>Note that for this approach the order matters and if instead you use the command <code class="docutils literal"><span class="pre">find</span> <span class="pre">/var/log/c*</span> <span class="pre">2&gt;&amp;1</span> <span class="pre">&gt;</span> <span class="pre">clogs.txt</span></code> the redirection will not work.</p>
</div>
<div class="section" id="the-bit-bucket">
<h3>The bit bucket<a class="headerlink" href="#the-bit-bucket" title="Permalink to this headline">¶</a></h3>
<p>The file <code class="docutils literal"><span class="pre">/dev/null</span></code> is a special file that discards all data written to it.
This file is used very often when <em>stdout</em> or <em>stderr</em> needs to be supressed.
This file is commonly known as the <em>bit bucket</em></p>
<p>Following the previous exemple, suppose you want to write <em>sdout</em> to <code class="docutils literal"><span class="pre">clogs.txt</span></code> and want to avoid the <em>Permission denied</em> errors showing on the terminal.
We can do that by sending <em>stderr</em> to <code class="docutils literal"><span class="pre">/dev/null</span></code>:</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">find /var/log/c* &gt; clogs.txt 2&gt; /dev/null</strong>
[user&#64;blue ~]$ <strong class="command">cat clogs.txt</strong>
/var/log/cassandra
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
</pre>
</div>
</div>
<div class="section" id="redirecting-stdin">
<h2>Redirecting stdin<a class="headerlink" href="#redirecting-stdin" title="Permalink to this headline">¶</a></h2>
<p>The cat command has a very useful feature that if no files are specified (that is, when it is executed without any arguments) then it reads text from <em>stdin</em>.</p>
<p>The <code class="docutils literal"><span class="pre">cat</span></code> command reads input from <em>stdin</em> and writes to <em>stdout</em>.
In the following example, once you press <code class="kbd docutils literal"><span class="pre">Enter</span></code> after typing the <code class="docutils literal"><span class="pre">cat</span></code> command, the terminal not return to the prompt immediately, and instead it will be reading any input you type. Type any test you want, notice how everytime that you hit enter the text gets written back to <em>stdout</em></p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">cat</strong>
<strong class="command">the</strong>
the
<strong class="command">quick</strong>
quick
<strong class="command">brown</strong>
brown
<strong class="command">fox</strong>
fox
</pre>
<p>To make <code class="docutils literal"><span class="pre">cat</span></code> stop reading text from <em>stdin</em> press the <code class="kbd docutils literal"><span class="pre">CRTL+D</span></code> combination.
This combinations sends a special non printable <code class="docutils literal"><span class="pre">EOF</span></code> (End of File) character.
Be careful! If you press this combination when you are not in a mode where a command is reading from <em>stdin</em>, you will send this character to the shell (<code class="docutils literal"><span class="pre">bash</span></code>) which will close your current session.</p>
<p>So if we execute the following command exactly the same result as if we were passing the argument directly.</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">cat &lt; clogs.txt</strong>
/var/log/cassandra
find: ‘/var/log/cassandra’: Permission denied
/var/log/chrony
/var/log/cluster
/var/log/cron
/var/log/cron-20200209
/var/log/cron-20200216
/var/log/cron-20200223
/var/log/cron-20200301
/var/log/cups
/var/log/custodia
find: ‘/var/log/custodia’: Permission denied
</pre>
</div>
<div class="section" id="using-pipes">
<h2>Using Pipes<a class="headerlink" href="#using-pipes" title="Permalink to this headline">¶</a></h2>
<p>We can use pipes to create elaborate command sequences where the output from one command is used as the input of another command.
This is done using the <em>pipe operator</em> <code class="docutils literal"><span class="pre">|</span></code>.</p>
<p>As an example, if you run the command <strong class="command">ls -l /usr/bin</strong> you’ll get a very long list of files. It will be much nicer to be able to page through those results.  The <code class="docutils literal"><span class="pre">less</span></code> command is a pager, and it will be great if we could pass the output from the <code class="docutils literal"><span class="pre">ls</span></code> command directly without having to write a file on disk.   Pipelines allows us to do just that in a very simple way.  Try running the command <strong class="command">ls -l /usr/bin | less</strong></p>
<p>Pipelines do not have to be composed of only two commands; they can chain as many commands as you need.  For example, what if you want to obtain the list of files under <code class="docutils literal"><span class="pre">/usr/bin</span></code>  that contain the word “gnome” on them, and then inspect thee output on a pager?  We can use the <code class="docutils literal"><span class="pre">grep</span></code> command to filter the output from <code class="docutils literal"><span class="pre">ls</span></code>: <strong class="command">ls /usr/bin/ | grep gnome | less</strong></p>
<div class="section" id="the-grep-command">
<h3>The <code class="docutils literal"><span class="pre">grep</span></code> command<a class="headerlink" href="#the-grep-command" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">grep</span></code> command is probably one of the most heavily utilized commands in Unix systems.  It allows you to search files that containe character strings that match a pattern.
<code class="docutils literal"><span class="pre">grep</span></code> allows you to define very complex search patterns, known as <em>regular expressions</em>.  In this lab section we’ll introduce the most basic patterns to use to search inside files.</p>
<p>Let’s download <em>Alice in Wonderland</em> , convert it to unix endings and search for the word <cite>Cheshire</cite> on it:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">wget -q http://www.gutenberg.org/files/11/11-0.txt</strong>
[user&#64;blue lab06]$ <strong class="command">dos2unix 11-0.txt</strong>
dos2unix: converting file 11-0.txt to Unix format...
[user&#64;blue lab06]$ <strong class="command">grep -e Cheshire 11-0.txt</strong>
“It’s a Cheshire cat,” said the Duchess, “and that’s why. Pig!”
“I didn’t know that Cheshire cats always grinned; in fact, I didn’t
was a little startled by seeing the Cheshire Cat sitting on a bough of
“Cheshire Puss,” she began, rather timidly, as she did not at all know
to herself “It’s the Cheshire Cat: now I shall have somebody to talk
“It’s a friend of mine—a Cheshire Cat,” said Alice: “allow me to
When she got back to the Cheshire Cat, she was surprised to find quite
</pre>
<p>In the previous command the <code class="docutils literal"><span class="pre">-e</span> <span class="pre">Cheshire</span></code> part specifies the <em>pattern</em> that we wanted <code class="docutils literal"><span class="pre">grep</span></code> to match. By default <code class="docutils literal"><span class="pre">grep</span></code> searches for patterns on a line-by-line basis. In this case, <code class="docutils literal"><span class="pre">Cheshire</span></code> means to match lines where the literal word <code class="docutils literal"><span class="pre">Cheshire</span></code> occurs anywhere within a line.</p>
<p><code class="docutils literal"><span class="pre">grep</span></code> allows you to specify very complex patterns using <strong>metacharacters</strong>.
One of the most common cases is when you need to match a line that starts with a specific word.
This can be done by using the caret <code class="docutils literal"><span class="pre">^</span></code> metacharacter which means “the begining of a line”.
For example, let’s search for those lines in the Alice in Wonderland book that start with the word “Alice”:</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">grep -e '^Alice' 11-0.txt</strong>
Alice’s Adventures in Wonderland
Alice was beginning to get very tired of sitting by her sister on the
Alice began to get rather sleepy, and went on saying to herself, in a
Alice was not a bit hurt, and she jumped up on to her feet in a moment:
Alice had been all the way down one side and up the other, trying every
... (output truncated for brevity)
</pre>
<p>In a similar way, we can use the dollar sign metacharacter <code class="docutils literal"><span class="pre">$</span></code> to specify “the end of line”.</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">grep -e Alice$ 11-0.txt</strong>
conversations in it, “and what is the use of a book,” thought Alice
size: to be sure, this generally happens when one eats cake, but Alice
Dodo, a Lory and an Eaglet, and several other curious creatures. Alice
“We must burn the house down!” said the Rabbit’s voice; and Alice
“Have you guessed the riddle yet?” the Hatter said, turning to Alice
always getting up and walking off to other parts of the ground, Alice
“Oh, a song, please, if the Mock Turtle would be so kind,” Alice
One of the jurors had a pencil that squeaked. This of course, Alice
</pre>
<p>The <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code> metacharacters are known as “anchors” because they let you specify a position within the line.</p>
<p>Another very commont metacharacter is the dot <code class="docutils literal"><span class="pre">.</span></code> which matches any characters. Let’s see that in action:</p>
<p>Let’s see that in action:</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">grep -e .atter 11-0.txt</strong>
either question, it didn’t much matter which way she put it. She felt
After a time she heard a little pattering of feet in the distance, and
shape doesn’t matter,” it said,) and then all the party were placed
little pattering of footsteps in the distance, and she looked up
Then came a little pattering of feet on the stairs. Alice knew it was
looking for eggs, I know _that_ well enough; and what does it matter to
“It matters a good deal to _me_,” said Alice hastily; “but I’m not
to see what was the matter with it. There could be no doubt that it had
“Then it doesn’t matter which way you go,” said the Cat.
... (output truncated for brevity)
</pre>
<p>The use of metacharacters poses one problem: how would we match a literal metacharacter?
For example, supposed you want to match all lines that end with “Cat.” (that is, “Cat” followed by a period)
We we use <code class="docutils literal"><span class="pre">Cat.</span></code> we get these results:</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">grep -e Cat. 11-0.txt</strong>
 CHAPTER V.     Advice from a Caterpillar
then the Rabbit’s voice along—“Catch him, you by the hedge!” then
Advice from a Caterpillar
The Caterpillar and Alice looked at each other for some time in
silence: at last the Caterpillar took the hookah out of its mouth, and
“Who are _you?_” said the Caterpillar.
</pre>
<p>This problem is solved by <strong>escaping</strong> the dot, which gives it back it literal meaning.
Escaping is done by prepending a backslash, and enclosing the pattern in single quotes:</p>
<pre class="literal-block">
[user&#64;blue ~]$ <strong class="command">grep -e 'Cat\.' 11-0.txt</strong>
“That depends a good deal on where you want to get to,” said the Cat.
“Then it doesn’t matter which way you go,” said the Cat.
“Call it what you like,” said the Cat. “Do you play croquet with the
“By-the-bye, what became of the baby?” said the Cat. “I’d nearly
“Did you say pig, or fig?” said the Cat.
</pre>
<p>We will cover the <code class="docutils literal"><span class="pre">grep</span></code> command with more details in future labs.</p>
</div>
<div class="section" id="the-tee-command">
<h3>The <code class="docutils literal"><span class="pre">tee</span></code> command<a class="headerlink" href="#the-tee-command" title="Permalink to this headline">¶</a></h3>
<p>The command <code class="docutils literal"><span class="pre">tee</span></code> sends its output in two directions at once: anything attached to <code class="docutils literal"><span class="pre">tee</span></code>’s <em>stdin</em> goes to both a file and to its <em>stdout</em> (its name is given because it acts as a “T” junction in a pipe).</p>
<p>As an example, the command the following commandwrites the listing of your home directory to both the terminal and to a file called <code class="docutils literal"><span class="pre">myhome.txt</span></code></p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">ls ~ | tee myhome.txt</strong>
</pre>
</div>
<div class="section" id="the-uniq-command">
<h3>The <code class="docutils literal"><span class="pre">uniq</span></code> command<a class="headerlink" href="#the-uniq-command" title="Permalink to this headline">¶</a></h3>
<p>The unique command takes a list and removes duplicated elements.</p>
<p>Let’s create a file that has many repeated words. For this we are going to use the <strong>heredoc</strong> form of reading from <em>stdin</em> and redirecting the output to a file calee <code class="docutils literal"><span class="pre">words.txt</span></code>:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">cat &lt;&lt; EOF &gt; words.txt</strong>
heredoc&gt; the quick brown fox jumped over the lazy dog
heredoc&gt; the quick brown fox jumped over the lazy dog
heredoc&gt; the quick brown fox jumped over the lazy dog
heredoc&gt; the quick brown fox jumped over the lazy dog
heredoc&gt; EOF
</pre>
<p>Now, if we call <code class="docutils literal"><span class="pre">uniq</span></code> with an argument of <code class="docutils literal"><span class="pre">words.txt</span></code> we can see that it removes duplicate lines:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">uniq words.txt</strong>
the quick brown fox jumped over the lazy dog
</pre>
<p>The <code class="docutils literal"><span class="pre">uniq</span></code> command also accepts reading from <em>stdin</em> when no arguments have been passed:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">uniq &lt; words.txt</strong>
the quick brown fox jumped over the lazy dog
</pre>
</div>
<div class="section" id="the-sort-command">
<h3>The <code class="docutils literal"><span class="pre">sort</span></code> command<a class="headerlink" href="#the-sort-command" title="Permalink to this headline">¶</a></h3>
<p>The sort command sorts a list.</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">cat &lt;&lt; EOF &gt; names.txt</strong>
heredoc&gt; henry
heredoc&gt; anna
heredoc&gt; zoey
heredoc&gt; charles
heredoc&gt; EOF
[user&#64;blue lab06]$ <strong class="command">sort names.txt</strong>
anna
charles
henry
zoey
</pre>
<p>Just as other commands we have learned, <code class="docutils literal"><span class="pre">sort</span></code> also accepts reading from <em>stdin</em> when no arguments are passed:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">sort &lt; names.txt</strong>
anna
charles
henry
zoey
</pre>
</div>
<div class="section" id="the-head-and-tail-commands">
<h3>The <code class="docutils literal"><span class="pre">head</span></code> and <code class="docutils literal"><span class="pre">tail</span></code> commands<a class="headerlink" href="#the-head-and-tail-commands" title="Permalink to this headline">¶</a></h3>
<p>The <cite>head</cite> and <cite>tail</cite> commands allow you to restrict output of a process or the content of a file to a certain number of lines from the top or from the bottom of a file.
The <code class="docutils literal"><span class="pre">-n</span></code> modifier lets you specify the number of files that you want these commands to return.</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">head -n 2 names.txt</strong>
henry
anna
</pre>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">tail -n 2 names.txt</strong>
zoey
charles
</pre>
<p>As before, these two commands accept input from <em>stdin</em></p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">head -n 2 &lt; names.txt</strong>
henry
anna
</pre>
</div>
<div class="section" id="building-a-command-pipeline">
<h3>Building a command pipeline<a class="headerlink" href="#building-a-command-pipeline" title="Permalink to this headline">¶</a></h3>
<p>Let’s put the commands we just learn to practice.
Supposed you are asked to find out which are the first two names in the file <code class="docutils literal"><span class="pre">names.txt</span></code> sorted in alphabetical order.
In order to get the answer, we need to first sort the contents of the file and then select the first two lines.
Without pipes, we would have to write the results of the <code class="docutils literal"><span class="pre">sort</span></code> command to a temporary file, and then we would execute the <code class="docutils literal"><span class="pre">head</span></code> command using that temporary file as and argument in order to obtain the desired output.
With pipes, we can do it all in a single command:</p>
<pre class="literal-block">
[user&#64;blue lab06]$ <strong class="command">sort names.txt  | head -n 2</strong>
anna
charles
</pre>
<div class="worksheet admonition">
<p class="first admonition-title">Part 1 (4 pts)</p>
<p>Suppose there are two files in your working directory, called <code class="docutils literal"><span class="pre">foo</span></code> and <code class="docutils literal"><span class="pre">bar</span></code> that have the following contents</p>
<pre class="literal-block">
[you&#64;blue ~]$ <strong class="command">cat foo</strong>
73
11
42
64
53
98
42
[you&#64;blue ~]$ <strong class="command">cat bar</strong>
35
22
66
11
29
80
</pre>
<ol class="arabic simple">
<li>Provide a command that will produce a file called <code class="docutils literal"><span class="pre">smallest.txt</span></code> with the 4 smallest numbers amongst the two files. if you inspect the contents of the resulting file, the output should be:</li>
</ol>
<pre class="last literal-block">
[user&#64;blue lab06]$ <strong class="command">cat smallest.txt</strong>
11
22
29
35
</pre>
</div>
<div class="worksheet admonition">
<p class="first admonition-title">Part 2 (6 pts)</p>
<p>In this exercise we will determine how many files of type <code class="docutils literal"><span class="pre">.png</span></code> with unique names exist in the <code class="docutils literal"><span class="pre">/home</span></code> directory.  You will build the command in a series of steps, please make sure that you include the resulting command at each step. Please include in your report all the commands at each step. Begin with providing a command that will list all the files recursively, with each file on its own line <strong class="command">ls -1R /home</strong>.</p>
<ol class="last arabic simple" start="2">
<li>The previous command will produce a very long output and some error messages due to permissions. The first task is to use redirection so you will not get any error messages in the output.</li>
<li>The next step is to filter so only the files that end with <code class="docutils literal"><span class="pre">.png</span></code> are shown.  Note that the <code class="docutils literal"><span class="pre">.</span></code> is a globing character so you will need to <em>escape</em> it (the default escape character is <code class="docutils literal"><span class="pre">\</span></code>).  Provide an augmented command so the output only reflects files that end in <code class="docutils literal"><span class="pre">.png</span></code>.</li>
<li>Enhance the command so the returned list is sorted.</li>
<li>Enhance the command so the returned list does not have any duplicated items</li>
<li>Add a pipe to the <code class="docutils literal"><span class="pre">wc</span></code> command so the number of files is printed (use the <code class="docutils literal"><span class="pre">-l</span></code> option to only print the number of lines)</li>
<li>Modify the previous command so the list of files is written to a file called <code class="docutils literal"><span class="pre">`png_list.out</span></code> but it still prints the number of files to the screen.</li>
</ol>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>